âœ… Canonical User State Logic Map

(What shows, when, and why)

ğŸ” Core Principle (Anchor This First)

The UI never teaches the framework.
The AI knows the framework.
The user only sees the output appropriate to their current dispute state.

No static education. No visible step lists. No roadmap leakage.

ğŸ§± Required State Fields (Minimum)

Each dispute must track (explicitly or derivable):

dispute_type                (inaccurate_reporting | identity_theft | etc.)
dv_sent                     (true/false)
dv_response_received        (true/false)
dv_response_quality         (unknown | deficient | sufficient)
cra_dispute_sent            (true/false)
cra_response_received       (true/false)
cra_response_result         (deleted | corrected | verified | no_response)
mov_sent                    (true/false)
direct_dispute_sent         (true/false)
escalation_status           (none | escalated)
user_tier                   (free | growth | compliance_plus)


âš ï¸ AI guidance is impossible without these.
If any are missing â†’ block generation.

ğŸ§  AI Guidance Availability Gate

AI guidance (and Next Step Letter) is ONLY available when ALL are true:

user_tier âˆˆ {growth, compliance_plus}
AND escalation_status = escalated
AND dv_sent = true
AND dv_response_received = true


If false â†’ show nothing (not even a disabled button).

ğŸ“„ â€œNext Step Letterâ€ Visibility Rules
Rule 1 â€” Never show a letter prematurely

âŒ Do NOT show if:

dv_sent = false

dv_response_received = false

dispute_type â‰  inaccurate_reporting

Rule 2 â€” Determine the ONLY letter allowed
ğŸŸ¦ Case A: DV sent, response received, CRA not yet disputed
dv_sent = true
dv_response_received = true
cra_dispute_sent = false


âœ… Show:

Next Step Letter = FCRA Â§611 CRA Dispute

This is the only allowed template

âŒ Never show:

Another DV

MOV

Direct Dispute

ğŸŸ© Case B: CRA disputed, CRA marked â€œverifiedâ€
cra_dispute_sent = true
cra_response_received = true
cra_response_result = verified
mov_sent = false


âœ… Show:

Next Step Letter = Method of Verification (MOV)

âŒ Never show:

CRA dispute again

Direct Dispute yet

ğŸŸ¨ Case C: MOV sent or skipped, inaccuracies persist
cra_response_result âˆˆ {verified, corrected}
mov_sent = true OR cra_failed_to_provide_verification = true
direct_dispute_sent = false


âœ… Show:

Next Step Letter = Direct Dispute to Furnisher (Â§623(a)(8))

ğŸŸ¥ Case D: Direct Dispute sent, still inaccurate
direct_dispute_sent = true
inaccuracy_persists = true


âœ… Show:

No letter

AI guidance switches to regulatory + legal education only

No copy buttons

ğŸ§  AI Output Constraints (Critical)

The AI must obey these hard rules:

The AI is FORBIDDEN from:

Recommending a DV if dv_sent = true

Recommending CRA dispute if cra_dispute_sent = true

Recommending MOV unless cra_response_result = verified

Recommending legal action unless all prior steps exist

Using directive language (â€œyou should sendâ€)

Required AI language pattern:

â€œBased on your dispute statusâ€¦â€

â€œOne option available at this stageâ€¦â€

â€œIf you choose to proceedâ€¦â€

ğŸš¨ Missing Data Failsafe (Very Important)

If ANY required state is missing or unknown:

dv_response_quality = unknown
OR cra_response_received = false
OR dates missing


Then:

âŒ Do NOT generate a letter
âŒ Do NOT show â€œNext Step Letterâ€ section

âœ… Show:

â€œWe need more information to determine the appropriate next step.â€

This protects you legally and prevents wrong sequencing.

ğŸ§© Where This Logic Lives

Backend / AI prompt â†’ full 8-step framework (hidden)

UI layer â†’ only checks state + renders allowed output

Database â†’ stores generated guidance snapshot (already done ğŸ‘)

ğŸ›¡ï¸ Why This Is Bulletproof

âœ” No static education = lower CROA risk

âœ” No duplicate disputes = procedural correctness

âœ” No premature escalation = defensible logic

âœ” No user â€œstrategy teachingâ€ = education framing preserved

âœ” AI canâ€™t drift because itâ€™s state-locked

âœ… Final Recommendation

Treat this as your single source of truth for:

AI prompt constraints

UI rendering conditions

Compliance review

Future audits